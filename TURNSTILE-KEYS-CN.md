# ğŸ”‘ Turnstile å¯†é’¥é…ç½®è¯´æ˜

## ä¸¤ä¸ªå¯†é’¥çš„åŒºåˆ«

Cloudflare Turnstile ä½¿ç”¨ä¸¤ä¸ªå¯†é’¥ï¼š

| å¯†é’¥ç±»å‹ | è‹±æ–‡åç§° | ç”¨é€” | ä¿å¯†æ€§ | é…ç½®ä½ç½® | å½“å‰çŠ¶æ€ |
|---------|---------|------|--------|---------|---------|
| **ç«™ç‚¹å¯†é’¥** | Site Key | å‰ç«¯è°ƒç”¨ widget | âŒ å…¬å¼€ | å‰ç«¯ä»£ç  | âœ… å·²é…ç½® |
| **å¯†é’¥** | Secret Key | åç«¯éªŒè¯ token | âœ… ä¿å¯† | Workers ç¯å¢ƒå˜é‡ | âœ… å·²é…ç½® |

---

## ğŸ¯ å½“å‰é…ç½®çŠ¶æ€

### 1. ç«™ç‚¹å¯†é’¥ï¼ˆSite Keyï¼‰

**ä½ç½®**: `src/user-pages.js` ç¬¬ 381 è¡Œ

```javascript
sitekey: '0x4AAAAAAAzX8PJx0lF_CDHO'
```

âœ… **å·²ç¡¬ç¼–ç åœ¨å‰ç«¯**ï¼Œæ— éœ€é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®

### 2. å¯†é’¥ï¼ˆSecret Keyï¼‰

**ä½ç½®**: Cloudflare Workers ç¯å¢ƒå˜é‡

```bash
$ wrangler secret list
...
TURNSTILE_SECRET_KEY âœ…
...
```

âœ… **å·²é…ç½®**

---

## â“ æˆ‘éœ€è¦åšä»€ä¹ˆï¼Ÿ

### ç­”æ¡ˆï¼šæ£€æŸ¥ç«™ç‚¹å¯†é’¥æ˜¯å¦åŒ¹é…

1. **ç™»å½• Cloudflare Dashboard**
   ```
   https://dash.cloudflare.com/?to=/:account/turnstile
   ```

2. **æŸ¥çœ‹ä½ çš„ Turnstile ç«™ç‚¹**
   - æ‰¾åˆ°ä½ åˆ›å»ºçš„ç«™ç‚¹ï¼ˆåº”è¯¥æ˜¯ imageaigo.ccï¼‰
   - æŸ¥çœ‹ **Site Key**ï¼ˆç«™ç‚¹å¯†é’¥ï¼‰

3. **å¯¹æ¯”å¯†é’¥**

   | ä½ çš„ç«™ç‚¹å¯†é’¥ | ä»£ç ä¸­çš„å¯†é’¥ | éœ€è¦æ“ä½œ |
   |------------|------------|---------|
   | `0x4AAAAAAAzX8PJx0lF_CDHO` | `0x4AAAAAAAzX8PJx0lF_CDHO` | âœ… æ— éœ€æ“ä½œ |
   | `0x4AAAAAAA...`ï¼ˆå…¶ä»–å€¼ï¼‰ | `0x4AAAAAAAzX8PJx0lF_CDHO` | âš ï¸ éœ€è¦æ›´æ–° |

---

## ğŸ”§ å¦‚æœç«™ç‚¹å¯†é’¥ä¸åŒæ€ä¹ˆåŠï¼Ÿ

### æ–¹æ³• 1: ä½¿ç”¨æ›´æ–°è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
./update-sitekey.sh
```

æŒ‰æç¤ºè¾“å…¥ä½ çš„æ–°ç«™ç‚¹å¯†é’¥ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨æ›´æ–°ä»£ç ã€‚

### æ–¹æ³• 2: æ‰‹åŠ¨æ›´æ–°

1. **ç¼–è¾‘æ–‡ä»¶** `src/user-pages.js`

2. **æ‰¾åˆ°è¿™ä¸€è¡Œ**ï¼ˆçº¦ç¬¬ 381 è¡Œï¼‰ï¼š
   ```javascript
   sitekey: '0x4AAAAAAAzX8PJx0lF_CDHO',
   ```

3. **æ›¿æ¢ä¸ºä½ çš„ç«™ç‚¹å¯†é’¥**ï¼š
   ```javascript
   sitekey: 'ä½ çš„ç«™ç‚¹å¯†é’¥',
   ```

4. **éƒ¨ç½²æ›´æ–°**ï¼š
   ```bash
   wrangler deploy
   ```

---

## ğŸ“Š å®Œæ•´é…ç½®æ¸…å•

### å‰ç«¯é…ç½®

- [x] Turnstile è„šæœ¬å·²åŠ è½½
  ```html
  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js"></script>
  ```

- [x] ç«™ç‚¹å¯†é’¥å·²é…ç½®
  ```javascript
  sitekey: '0x4AAAAAAAzX8PJx0lF_CDHO'
  ```

- [x] Widget å®¹å™¨å·²åˆ›å»º
  ```html
  <div id="turnstile1"></div>
  <div id="turnstile2"></div>
  ```

- [x] æ˜¾å¼æ¸²æŸ“é€»è¾‘å·²å®ç°
  ```javascript
  turnstile.render('#turnstile1', { sitekey: '...', theme: 'light' })
  ```

### åç«¯é…ç½®

- [x] Secret Key å·²é…ç½®
  ```bash
  wrangler secret put TURNSTILE_SECRET_KEY
  ```

- [x] éªŒè¯é€»è¾‘å·²å®ç°
  ```javascript
  // src/brute-force-protection.js
  verifyTurnstile(token, ip, env)
  ```

---

## ğŸ§ª éªŒè¯é…ç½®

### 1. å¿«é€Ÿæ£€æŸ¥

```bash
./check-turnstile.sh
```

åº”è¯¥æ˜¾ç¤ºå…¨éƒ¨ âœ…

### 2. åŠŸèƒ½æµ‹è¯•

1. è®¿é—® https://imageaigo.cc/login
2. è¾“å…¥é”™è¯¯å¯†ç  2 æ¬¡
3. Turnstile widget åº”è¯¥å‡ºç°
4. å®ŒæˆéªŒè¯åå¯ä»¥ç™»å½•

### 3. æŸ¥çœ‹æ—¥å¿—

```bash
wrangler tail
```

æˆåŠŸæ—¶åº”è¯¥çœ‹åˆ°ï¼š
```
[Turnstile] Verification successful
```

---

## ğŸ¯ å¸¸è§é—®é¢˜

### Q1: æˆ‘æ²¡æœ‰åˆ›å»º Turnstile ç«™ç‚¹æ€ä¹ˆåŠï¼Ÿ

**A**: å¯ä»¥ç›´æ¥ä½¿ç”¨å½“å‰çš„ç«™ç‚¹å¯†é’¥ï¼Œæˆ–è€…åˆ›å»ºè‡ªå·±çš„ï¼š

1. è®¿é—® https://dash.cloudflare.com/?to=/:account/turnstile
2. ç‚¹å‡» **Add Site**
3. è¾“å…¥åŸŸå: `imageaigo.cc`
4. é€‰æ‹© Widget Mode: **Managed**
5. è·å– Site Key å’Œ Secret Key
6. æ›´æ–°ä»£ç ä¸­çš„ç«™ç‚¹å¯†é’¥
7. æ›´æ–° Workers ç¯å¢ƒå˜é‡ä¸­çš„ Secret Key

### Q2: ç«™ç‚¹å¯†é’¥å¯ä»¥å…¬å¼€å—ï¼Ÿ

**A**: âœ… å¯ä»¥ï¼ç«™ç‚¹å¯†é’¥æœ¬æ¥å°±æ˜¯å…¬å¼€çš„ï¼Œç”¨æˆ·å¯ä»¥åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°ã€‚è¿™æ˜¯æ­£å¸¸çš„ã€‚

**ä¸èƒ½å…¬å¼€çš„æ˜¯ Secret Key**ï¼ˆå¯†é’¥ï¼‰ï¼Œå®ƒå¿…é¡»ä¿å¯†ï¼Œåªèƒ½åœ¨åç«¯ä½¿ç”¨ã€‚

### Q3: å¦‚ä½•çŸ¥é“å½“å‰ä½¿ç”¨çš„æ˜¯å“ªä¸ªå¯†é’¥ï¼Ÿ

**A**: 

**ç«™ç‚¹å¯†é’¥**:
```bash
grep -n "sitekey:" src/user-pages.js
```

**Secret Key**:
```bash
wrangler secret list | grep TURNSTILE
```

### Q4: å¯ä»¥ä½¿ç”¨æµ‹è¯•å¯†é’¥å—ï¼Ÿ

**A**: Cloudflare æä¾›æµ‹è¯•å¯†é’¥ï¼š

**æµ‹è¯•ç«™ç‚¹å¯†é’¥**:
```
1x00000000000000000000AA  # æ€»æ˜¯é€šè¿‡
2x00000000000000000000AB  # æ€»æ˜¯å¤±è´¥
3x00000000000000000000FF  # å¼ºåˆ¶äº¤äº’
```

ä»…ç”¨äºå¼€å‘æµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨çœŸå®å¯†é’¥ã€‚

---

## ğŸ“ æ€»ç»“

### ä½ éœ€è¦åšçš„äº‹æƒ…

1. âœ… **ç¡®è®¤ç«™ç‚¹å¯†é’¥æ˜¯å¦åŒ¹é…**
   - ç™»å½• Cloudflare Dashboard
   - æŸ¥çœ‹ä½ çš„ Turnstile Site Key
   - å¯¹æ¯”ä»£ç ä¸­çš„å€¼

2. âœ… **å¦‚æœå¯†é’¥ä¸åŒ**
   - è¿è¡Œ `./update-sitekey.sh` æ›´æ–°
   - æˆ–æ‰‹åŠ¨ä¿®æ”¹ `src/user-pages.js`
   - éƒ¨ç½²: `wrangler deploy`

3. âœ… **å¦‚æœå¯†é’¥ç›¸åŒ**
   - æ— éœ€ä»»ä½•æ“ä½œ
   - ç›´æ¥æµ‹è¯•åŠŸèƒ½

4. âœ… **æµ‹è¯•éªŒè¯**
   - è®¿é—®ç™»å½•é¡µé¢
   - è§¦å‘ Turnstileï¼ˆå¤±è´¥ 2 æ¬¡ï¼‰
   - å®ŒæˆéªŒè¯

### ä½ ä¸éœ€è¦åšçš„äº‹æƒ…

- âŒ ä¸éœ€è¦é…ç½®ç«™ç‚¹å¯†é’¥ä¸ºç¯å¢ƒå˜é‡
- âŒ ä¸éœ€è¦æŠŠç«™ç‚¹å¯†é’¥è®¾ä¸º secret
- âŒ ä¸éœ€è¦éšè—ç«™ç‚¹å¯†é’¥ï¼ˆæœ¬æ¥å°±æ˜¯å…¬å¼€çš„ï¼‰

---

**å¦‚æœä½ çš„ç«™ç‚¹å¯†é’¥å°±æ˜¯ `0x4AAAAAAAzX8PJx0lF_CDHO`ï¼Œé‚£ä¹ˆé…ç½®å·²ç»å®Œæˆï¼Œç›´æ¥æµ‹è¯•å³å¯ï¼** âœ…

