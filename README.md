# ğŸ¨ ImageAI Go

> åŸºäº Cloudflare Workers çš„ AI å›¾ç‰‡åˆ†æä¸ç®¡ç†å¹³å°

[![éƒ¨ç½²çŠ¶æ€](https://img.shields.io/badge/deploy-active-brightgreen)](https://imageaigo.cc)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)

ä¸€ä¸ªå®Œå…¨è¿è¡Œåœ¨ Cloudflare Edge ç½‘ç»œä¸Šçš„ç°ä»£åŒ–å›¾ç‰‡ç®¡ç†å¹³å°ï¼Œä½¿ç”¨ AI è‡ªåŠ¨åˆ†æå›¾ç‰‡ã€ç”Ÿæˆæè¿°å’Œæ™ºèƒ½æ ‡ç­¾ï¼Œæä¾›ä¼˜é›…çš„ç€‘å¸ƒæµå±•ç¤ºå’Œå¼ºå¤§çš„æœç´¢åŠŸèƒ½ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ¤– AI æ™ºèƒ½åˆ†æ
- **è‡ªåŠ¨æè¿°ç”Ÿæˆ** - åŸºäº Llama 3.2 11B Vision æ¨¡å‹ï¼Œç”Ÿæˆç²¾å‡†çš„å›¾ç‰‡æè¿°
- **ä¸‰çº§æ ‡ç­¾ä½“ç³»** - ä¸»åˆ†ç±»ã€å­åˆ†ç±»ã€å±æ€§æ ‡ç­¾çš„å±‚çº§åŒ–ç»„ç»‡
- **æ™ºèƒ½å»é‡** - SHA-256 å“ˆå¸Œè‡ªåŠ¨æ£€æµ‹é‡å¤å›¾ç‰‡
- **å°ºå¯¸è¯†åˆ«** - è‡ªåŠ¨æå– JPEG/PNG/GIF/WebP å›¾ç‰‡çš„å®½é«˜ä¿¡æ¯

### ğŸ¨ ç°ä»£åŒ–ç•Œé¢
- **å“åº”å¼ç€‘å¸ƒæµ** - å®Œç¾é€‚é…æ¡Œé¢ç«¯ï¼ˆ4-8åˆ—ï¼‰å’Œç§»åŠ¨ç«¯ï¼ˆ2åˆ—ï¼‰
- **ä¿æŒå®½é«˜æ¯”** - å›¾ç‰‡æŒ‰åŸå§‹æ¯”ä¾‹æ˜¾ç¤ºï¼Œæ— è£å‰ªå˜å½¢
- **æµç•…äº¤äº’** - æ‚¬åœæ•ˆæœã€å¹³æ»‘åŠ¨ç”»ã€æ¸è¿›å¼åŠ è½½
- **PWA æ”¯æŒ** - å¯å®‰è£…ã€ç¦»çº¿æµè§ˆã€Service Worker ç¼“å­˜

### ğŸ” å®Œæ•´ç”¨æˆ·ç³»ç»Ÿ
- **ç”¨æˆ·æ³¨å†Œç™»å½•** - é‚®ç®±æ³¨å†Œã€å¯†ç åŠ å¯†ã€ä¼šè¯ç®¡ç†
- **å¯†ç æ‰¾å›** - å®‰å…¨çš„å¯†ç é‡ç½®æµç¨‹
- **ä¸ªäººä¸­å¿ƒ** - ç”¨æˆ·èµ„æ–™ã€å¤´åƒã€å›¾ç‰‡ç®¡ç†
- **è®¿é—®æ§åˆ¶** - æ ¸å¿ƒåŠŸèƒ½éœ€ç™»å½•è®¿é—®

### ğŸ” å¼ºå¤§æœç´¢
- **å…¨æ–‡æœç´¢** - æ”¯æŒæè¿°å’Œæ ‡ç­¾çš„æ¨¡ç³Šæœç´¢
- **åˆ†ç±»æµè§ˆ** - æŒ‰ä¸»åˆ†ç±»å¿«é€Ÿç­›é€‰
- **æ ‡ç­¾ç­›é€‰** - å¤šç»´åº¦æ ‡ç­¾ç»„åˆæŸ¥è¯¢
- **æ™ºèƒ½æ¨è** - åŸºäºæ ‡ç­¾ç›¸ä¼¼åº¦çš„å›¾ç‰‡æ¨è

### ğŸ›¡ï¸ ç®¡ç†åå°
- **æ•°æ®ç»Ÿè®¡** - å®æ—¶å›¾ç‰‡ã€æ ‡ç­¾ã€ç”¨æˆ·ç»Ÿè®¡
- **å›¾ç‰‡ç®¡ç†** - æŸ¥çœ‹ã€æœç´¢ã€åˆ é™¤ã€é‡æ–°åˆ†æ
- **æ ‡ç­¾ç®¡ç†** - ç®¡ç†æ ‡ç­¾ã€æŸ¥çœ‹ä½¿ç”¨æƒ…å†µ
- **æ‰¹é‡ä¸Šä¼ ** - æ”¯æŒæ‹–æ‹½ã€é˜Ÿåˆ—å¤„ç†ã€å®æ—¶è¿›åº¦
- **ç”¨æˆ·ç®¡ç†** - ç”¨æˆ·ä¿¡æ¯ç®¡ç†å’Œæƒé™æ§åˆ¶
- **ç³»ç»Ÿæ¸…ç†** - R2 å­˜å‚¨ã€KV ç¼“å­˜ã€æ•°æ®åº“æ¸…ç†

### âš¡ æè‡´æ€§èƒ½
- **å¤šçº§ç¼“å­˜** - å†…å­˜ç¼“å­˜ + KV ç¼“å­˜ + æ•°æ®åº“ï¼Œå‘½ä¸­ç‡ 70%+
- **æ•°æ®åº“ä¼˜åŒ–** - 8 ä¸ªå…³é”®ç´¢å¼•ï¼ŒæŸ¥è¯¢é€Ÿåº¦æå‡ 60-80%
- **æ‰¹é‡æŸ¥è¯¢** - N+1 æŸ¥è¯¢ä¼˜åŒ–ï¼Œä» 21 æ¬¡é™è‡³ 2 æ¬¡
- **æ™ºèƒ½å‹ç¼©** - ä¸Šä¼ æ—¶è‡ªåŠ¨å‹ç¼©ç”¨äº AI åˆ†æ
- **CDN åŠ é€Ÿ** - Cloudflare å…¨çƒ 300+ èŠ‚ç‚¹è¾¹ç¼˜ç¼“å­˜

### ğŸŒ SEO ä¼˜åŒ–
- **åŠ¨æ€ Sitemap** - è‡ªåŠ¨ç”Ÿæˆç¬¦åˆ Google è§„èŒƒçš„ Sitemap
- **ç»“æ„åŒ–æ•°æ®** - Schema.org å®Œæ•´æ”¯æŒ
- **Open Graph** - ç¤¾äº¤åª’ä½“åˆ†äº«ä¼˜åŒ–
- **è¯­ä¹‰åŒ– HTML** - å®Œå–„çš„æ ‡ç­¾å±‚çº§å’Œ ARIA
- **Google Analytics** - GA4 é›†æˆå’Œäº‹ä»¶è¿½è¸ª

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

```bash
# Node.js 18+
node -v  # >= 18.0.0

# å®‰è£… Wrangler CLI
npm install -g wrangler

# ç™»å½• Cloudflare
wrangler login
```

### å®‰è£…éƒ¨ç½²

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/imageaigo.git
cd imageaigo

# 2. å®‰è£…ä¾èµ–
npm install

# 3. åˆ›å»ºèµ„æº
wrangler d1 create imageaigo
wrangler r2 bucket create imageaigo
wrangler kv:namespace create "CACHE"

# 4. åˆå§‹åŒ–æ•°æ®åº“
wrangler d1 execute imageaigo --remote --file=schema.sql

# 5. è®¾ç½®ç¯å¢ƒå˜é‡
wrangler secret put ADMIN_PASSWORD
wrangler secret put ADMIN_SECRET

# 6. éƒ¨ç½²
npm run deploy
```

### é…ç½®è¯´æ˜

æ›´æ–° `wrangler.toml` ä¸­çš„èµ„æº IDï¼š

```toml
[[d1_databases]]
binding = "DB"
database_name = "imageaigo"
database_id = "YOUR_D1_DATABASE_ID"  # æ›¿æ¢ä¸ºå®é™… ID

[[kv_namespaces]]
binding = "CACHE"
id = "YOUR_KV_NAMESPACE_ID"  # æ›¿æ¢ä¸ºå®é™… ID
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ç”¨æˆ·ç«¯

1. **æ³¨å†Œè´¦å·** - è®¿é—® `/register`ï¼Œå¡«å†™é‚®ç®±å’Œå¯†ç 
2. **ç™»å½•** - è®¿é—® `/login`ï¼Œä½¿ç”¨æ³¨å†Œçš„è´¦å·ç™»å½•
3. **ä¸Šä¼ å›¾ç‰‡** - ç™»å½•ååœ¨é¦–é¡µæ‹–æ‹½æˆ–é€‰æ‹©å›¾ç‰‡ä¸Šä¼ 
4. **AI åˆ†æ** - ç³»ç»Ÿè‡ªåŠ¨åˆ†æå›¾ç‰‡å¹¶ç”Ÿæˆæè¿°å’Œæ ‡ç­¾ï¼ˆ10-30ç§’ï¼‰
5. **æµè§ˆæŸ¥çœ‹** - åœ¨ç€‘å¸ƒæµä¸­æµè§ˆæ‰€æœ‰å›¾ç‰‡
6. **æœç´¢ç­›é€‰** - ä½¿ç”¨æœç´¢æ¡†æˆ–ç‚¹å‡»æ ‡ç­¾è¿›è¡Œç­›é€‰

### ç®¡ç†ç«¯

1. **ç™»å½•åå°** - è®¿é—® `/admin/login`ï¼Œä½¿ç”¨ç®¡ç†å‘˜å¯†ç ç™»å½•
2. **æ‰¹é‡ä¸Šä¼ ** - æ”¯æŒä¸€æ¬¡ä¸Šä¼ å¤šå¼ å›¾ç‰‡ï¼Œé˜Ÿåˆ—è‡ªåŠ¨å¤„ç†
3. **ç®¡ç†å›¾ç‰‡** - æŸ¥çœ‹ã€æœç´¢ã€åˆ é™¤ã€é‡æ–°åˆ†æå›¾ç‰‡
4. **ç®¡ç†ç”¨æˆ·** - æŸ¥çœ‹å’Œç®¡ç†æ³¨å†Œç”¨æˆ·
5. **æŸ¥çœ‹ç»Ÿè®¡** - å®æ—¶æŸ¥çœ‹ç³»ç»Ÿæ•°æ®ç»Ÿè®¡

### API æ¥å£

#### å…¬å¼€æ¥å£

```bash
# è·å–å›¾ç‰‡åˆ—è¡¨
GET /api/images?limit=20&page=1

# æœç´¢å›¾ç‰‡
GET /api/search?q=å…³é”®è¯

# è·å–å›¾ç‰‡è¯¦æƒ…
GET /api/image?id=123

# è·å–åˆ†ç±»åˆ—è¡¨
GET /api/categories

# ç‚¹èµå›¾ç‰‡
POST /api/like { imageId: 123 }
```

#### ç®¡ç†æ¥å£ï¼ˆéœ€è¦ Tokenï¼‰

```bash
# ç®¡ç†å‘˜ç™»å½•
POST /api/admin/login
Body: { "password": "your_password" }

# è·å–ç»Ÿè®¡
GET /api/admin/stats
Header: Authorization: Bearer <token>

# æ‰¹é‡ä¸Šä¼ 
POST /api/admin/batch-upload
Header: Authorization: Bearer <token>
Content-Type: multipart/form-data
```

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| **è¿è¡Œæ—¶** | Cloudflare Workers | å…¨çƒè¾¹ç¼˜è®¡ç®— |
| **æ•°æ®åº“** | D1 (SQLite) | å…³ç³»å‹æ•°æ®åº“ |
| **å­˜å‚¨** | R2 | å¯¹è±¡å­˜å‚¨ï¼ˆå…¼å®¹ S3ï¼‰ |
| **ç¼“å­˜** | KV | é”®å€¼å­˜å‚¨ |
| **é˜Ÿåˆ—** | Queue | æ¶ˆæ¯é˜Ÿåˆ— |
| **AI** | Llama 3.2 11B Vision | å›¾ç‰‡è§†è§‰æ¨¡å‹ |
| **å‰ç«¯** | åŸç”Ÿ JavaScript | æ— æ¡†æ¶ä¾èµ– |

### é¡¹ç›®ç»“æ„

```
imageaigo/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.js              # ä¸»è·¯ç”±å’Œæ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ auth.js               # ç”¨æˆ·è®¤è¯æ¨¡å—
â”‚   â”œâ”€â”€ auth-middleware.js    # è®¤è¯ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ analyzer.js           # AI å›¾ç‰‡åˆ†æ
â”‚   â”œâ”€â”€ queue-handler.js      # é˜Ÿåˆ—æ¶ˆæ¯å¤„ç†
â”‚   â”œâ”€â”€ recommendations.js    # æ¨èç®—æ³•
â”‚   â”œâ”€â”€ admin.js              # ç®¡ç†åå°é¡µé¢
â”‚   â”œâ”€â”€ admin-users.js        # ç”¨æˆ·ç®¡ç†
â”‚   â”œâ”€â”€ profile-page.js       # ä¸ªäººä¸­å¿ƒ
â”‚   â”œâ”€â”€ user-pages.js         # è®¤è¯é¡µé¢
â”‚   â”œâ”€â”€ components/           # UI ç»„ä»¶åº“
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”œâ”€â”€ templates/            # é¡µé¢æ¨¡æ¿
â”‚   â”‚   â””â”€â”€ layout.js
â”‚   â”œâ”€â”€ client/               # å®¢æˆ·ç«¯è„šæœ¬
â”‚   â”‚   â””â”€â”€ gallery.js
â”‚   â”œâ”€â”€ lib/                  # å·¥å…·åº“
â”‚   â”‚   â”œâ”€â”€ validation.js
â”‚   â”‚   â””â”€â”€ performance.js
â”‚   â”œâ”€â”€ html-builder.js       # HTML æ„å»ºå™¨
â”‚   â”œâ”€â”€ styles.js             # CSS æ ·å¼
â”‚   â””â”€â”€ utils.js              # å·¥å…·å‡½æ•°
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ sw.js                 # Service Worker
â”‚   â”œâ”€â”€ offline.html          # ç¦»çº¿é¡µé¢
â”‚   â””â”€â”€ manifest.json         # PWA é…ç½®
â”œâ”€â”€ schema.sql                # æ•°æ®åº“ç»“æ„
â”œâ”€â”€ wrangler.toml             # Cloudflare é…ç½®
â””â”€â”€ package.json              # é¡¹ç›®é…ç½®
```

## ğŸ¯ æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| **é¦–å±åŠ è½½** | < 1s | å¤šçº§ç¼“å­˜ä¼˜åŒ– |
| **API å“åº”** | 10-20ms | ç¼“å­˜å‘½ä¸­æ—¶ |
| **ç¼“å­˜å‘½ä¸­ç‡** | 70%+ | KV + å†…å­˜ç¼“å­˜ |
| **æ•°æ®åº“æŸ¥è¯¢** | 2 æ¬¡/è¯·æ±‚ | N+1 ä¼˜åŒ–å |
| **å…¨çƒå»¶è¿Ÿ** | < 50ms | è¾¹ç¼˜èŠ‚ç‚¹åŠ é€Ÿ |

## ğŸ”§ ç»´æŠ¤ç®¡ç†

### ä¿®æ”¹ç®¡ç†å‘˜å¯†ç 

```bash
# æ–¹æ³•1ï¼šä½¿ç”¨è„šæœ¬
./change-admin-password.sh

# æ–¹æ³•2ï¼šæ‰‹åŠ¨ä¿®æ”¹
wrangler secret put ADMIN_PASSWORD
wrangler secret put ADMIN_SECRET
wrangler deploy
```

### æ¸…ç†ç¼“å­˜

```bash
# æ¸…ç† Sitemap ç¼“å­˜
./clear-sitemap-cache.sh

# é€šè¿‡ç®¡ç†åå°æ¸…ç†
è®¿é—® /admin â†’ ç³»ç»Ÿç®¡ç† â†’ é€‰æ‹©æ¸…ç†é€‰é¡¹
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹ Worker æ—¥å¿—
wrangler tail

# æŸ¥çœ‹ Queue çŠ¶æ€
wrangler queues list
```

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- âœ… **å¯†ç åŠ å¯†** - SHA-256 å“ˆå¸Œå­˜å‚¨
- âœ… **ä¼šè¯å®‰å…¨** - HttpOnlyã€Secureã€SameSite Cookie
- âœ… **è®¿é—®æ§åˆ¶** - Token è®¤è¯å’Œæƒé™ç®¡ç†
- âœ… **é€Ÿç‡é™åˆ¶** - IP çº§åˆ«ä¸Šä¼ é™åˆ¶ï¼ˆ10æ¬¡/å°æ—¶ï¼‰
- âœ… **è¾“å…¥éªŒè¯** - å¤šå±‚éªŒè¯å’Œ XSS é˜²æŠ¤
- âœ… **é˜²ç›—é“¾** - R2 èµ„æºè®¿é—®æ§åˆ¶
- âœ… **æœºå™¨äººæ£€æµ‹** - è¯†åˆ«å¯ç–‘è¡Œä¸º

## ğŸ“ å¸¸è§é—®é¢˜

**Q: å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Ÿ**  
A: æ£€æŸ¥æ ¼å¼ï¼ˆJPEG/PNG/GIF/WebPï¼‰å’Œå¤§å°ï¼ˆ<20MBï¼‰

**Q: AI åˆ†æè¶…æ—¶ï¼Ÿ**  
A: AI è´Ÿè½½é«˜æ—¶å¯èƒ½è¶…æ—¶ï¼Œè¯·ç¨åé‡è¯•æˆ–å‹ç¼©å›¾ç‰‡

**Q: ç®¡ç†åå°æ— æ³•ç™»å½•ï¼Ÿ**  
A: ç¡®ä¿å·²è®¾ç½® `ADMIN_PASSWORD` ç¯å¢ƒå˜é‡å¹¶é‡æ–°éƒ¨ç½²

**Q: æç¤ºé€Ÿç‡é™åˆ¶ï¼Ÿ**  
A: æ¯ IP æ¯å°æ—¶é™åˆ¶ 10 æ¬¡ä¸Šä¼ ï¼Œè¯·ç­‰å¾…æˆ–ä½¿ç”¨ç®¡ç†åå°æ‰¹é‡ä¸Šä¼ 

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

**å¼€å‘æµç¨‹ï¼š**
1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æäº¤ Pull Request

**å¼€å‘è§„èŒƒï¼š**
- éµå¾ªç°æœ‰ä»£ç é£æ ¼
- æ·»åŠ å¿…è¦çš„æ³¨é‡Š
- æ›´æ–°ç›¸å…³æ–‡æ¡£
- ç¡®ä¿æµ‹è¯•é€šè¿‡

## ğŸ“„ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºåè®®ã€‚

## ğŸ™ è‡´è°¢

- [Cloudflare Workers](https://workers.cloudflare.com/) - Edge è®¡ç®—å¹³å°
- [Llama 3.2 Vision](https://ai.meta.com/) - AI è§†è§‰æ¨¡å‹
- [D1 Database](https://developers.cloudflare.com/d1/) - SQLite æ•°æ®åº“
- [R2 Storage](https://developers.cloudflare.com/r2/) - å¯¹è±¡å­˜å‚¨

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ Starï¼

è®¿é—®åœ¨çº¿æ¼”ç¤ºï¼š[https://imageaigo.cc](https://imageaigo.cc)
